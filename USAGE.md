# 使用说明

## 🚀 快速开始

### 1. 启动应用

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

访问 [http://localhost:3000](http://localhost:3000)

### 2. 准备 CSV 文件

创建包含以下格式的 CSV 文件：

```csv
序号,提示词
1,一只蓝色的小猫，像素风格
2,夕阳下的城市天际线，油画风格
3,未来主义的机器人，科幻风格
```

**要求：**
- 第一列：序号（正整数）
- 第二列：提示词（字符串）
- 编码：UTF-8
- 支持表头（可选）

### 3. 上传和生成

1. **上传文件**：拖拽 CSV 文件到上传区域，或点击选择文件
2. **检查解析**：查看解析结果统计（总行数、有效行数、无效行数）
3. **设置并发**：选择并发数（1-3，默认为1）
4. **开始生成**：点击"开始生成"按钮
5. **监控进度**：实时查看任务状态和进度
6. **查看结果**：点击图片预览，下载单个图片
7. **导出结果**：导出所有结果到 CSV 文件

## 📋 功能详解

### 任务状态

- **等待中** (idle)：任务已创建，等待处理
- **生成中** (generating)：正在调用生成接口
- **成功** (succeeded)：图片生成成功
- **失败** (failed)：生成失败，可重试
- **已停止** (stopped)：用户手动停止

### 并发控制

- **1 (串行)**：逐个处理任务，最稳定
- **2 (并发)**：同时处理2个任务，平衡速度和稳定性
- **3 (高并发)**：同时处理3个任务，速度最快但可能触发限流

### 重试机制

- 失败任务自动重试，最多3次
- 指数退避延迟：第1次1秒，第2次2秒，第3次4秒
- 支持手动重试单个失败任务
- 支持批量重试所有失败任务

### 结果管理

- **图片预览**：点击缩略图查看大图
- **图片下载**：点击下载按钮保存到本地
- **结果导出**：导出包含图片URL的CSV文件
- **统计信息**：实时显示成功/失败数量

## 🔧 高级功能

### 批量操作

- **开始生成**：处理所有等待中的任务
- **停止生成**：停止当前正在进行的任务
- **重试失败**：重新处理所有失败的任务
- **清空所有**：清除所有任务和结果

### 错误处理

- **CSV 解析错误**：显示具体错误行和原因
- **网络错误**：自动重试，超过次数后标记失败
- **限流错误**：建议降低并发数
- **参数错误**：直接标记失败，不重试

### 性能优化

- **分页显示**：大量任务时分页显示，每页50条
- **虚拟滚动**：支持处理数千个任务
- **图片懒加载**：缩略图按需加载
- **状态缓存**：避免不必要的重新渲染

## 📊 统计信息

### 实时统计

- **总任务数**：CSV 文件中的有效行数
- **进行中**：当前正在处理的任务数
- **成功数**：已成功生成图片的任务数
- **失败数**：生成失败的任务数
- **成功率**：成功数 / 已完成数 * 100%

### 进度条

- 显示总体完成进度
- 颜色编码：蓝色（进行中）、绿色（成功）、红色（失败）

## 🎨 界面说明

### 上传区域

- 支持拖拽上传
- 文件类型验证
- 解析结果统计
- 示例文件下载

### 操作栏

- 任务统计卡片
- 控制按钮组
- 并发数选择
- 进度条显示

### 任务表格

- 序号和提示词列
- 状态指示器
- 尝试次数
- 结果预览
- 操作按钮

### 图片预览

- 全屏模态框
- 图片放大显示
- 下载和分享功能
- 键盘快捷键支持

## 🚨 注意事项

### 文件要求

- CSV 文件必须是 UTF-8 编码
- 序号必须是正整数
- 提示词不能为空
- 建议单次处理不超过 5000 个任务

### 网络要求

- 需要稳定的网络连接
- 生成接口可能有延迟
- 建议在网络良好时使用

### 浏览器兼容

- 支持现代浏览器（Chrome、Firefox、Safari、Edge）
- 需要支持 ES6+ 和 FileReader API
- 建议使用最新版本浏览器

## 🔍 故障排除

### 常见问题

1. **CSV 解析失败**
   - 检查文件编码是否为 UTF-8
   - 确认文件格式正确
   - 检查是否有空行或格式错误

2. **图片生成失败**
   - 检查网络连接
   - 尝试降低并发数
   - 查看错误信息详情

3. **页面卡顿**
   - 减少任务数量
   - 使用分页功能
   - 刷新页面重新开始

4. **导出失败**
   - 检查浏览器下载设置
   - 确认有足够的磁盘空间
   - 尝试使用其他浏览器

### 性能建议

- 单次处理建议不超过 1000 个任务
- 使用串行模式（并发数=1）最稳定
- 定期保存结果，避免数据丢失
- 网络不稳定时建议降低并发数

## 📞 技术支持

如果遇到问题，请检查：

1. 浏览器控制台是否有错误信息
2. 网络连接是否正常
3. CSV 文件格式是否正确
4. 是否使用了支持的浏览器版本

---

**提示**：这是一个 MVP 版本，主要用于演示批量文生图的前端实现。生产环境使用请根据实际需求进行安全性和性能优化。




